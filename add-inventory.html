<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Add Inventory</title>
  <link rel="stylesheet" href="add-inventory.css" />
  <!-- üÖ∞Ô∏è Google Fonts: Display Serif Font -->
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&display=swap" rel="stylesheet"/>
  <!-- üß± Google Icons: Outlined and Filled -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
  
  <main class="add-inventory-wrapper">

    <button id="toggle-controller" class="toggle-controller-btn" title="Show/Hide Controls" aria-label="Toggle Controls">
      <svg class="icon" xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M3 9.5L12 3l9 6.5V20a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V9.5z"/>
        <path d="M9 22V12h6v10"/>
      </svg>
    </button>
    

    <div class="container sticky">
      <!-- üîπ Unified Sticky Header Control Bar -->
      <header class="stock-header sticky">
        <div class="top-controls">
          <!-- üîô Back Button to Dashboard -->
          <a href="dashboard.html" class="back-button">
            <i data-lucide="arrow-left" class="icon"></i> Back
          </a>
          <input type="text" id="input-to-search-inventory-item" placeholder="Scan barcode here..." autocomplete="off" />
        </div>
      </header>
      </div>
    </div>

    <section class="batch-section">
      <h2 id="current-batch-heading">Current Batch</h2>
      <div id="batch-items-container" class="batch-container">
        <!-- Items being added will be rendered here -->
      </div>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js" defer></script>
  <script src="initSupabase.js" defer></script>
  <script src="add-inventory.js" defer></script>

  <!-- üì¢ Toast + Loading Spinner Containers -->
  <div id="toast-container"></div>

  <!-- Modal Popup -->
    <!-- Modal to Confirm Item -->
    <div id="modalToConfirmItem" class="modal hidden">
      <div class="modal-content-confirmitem">
        
        <!-- Modal Title Header -->
        <div class="modal-header">
          Confirm Item
        </div>
    
        <!-- Scrollable Content Section -->
        <div class="modal-body-scrollable">
          <div id="modalItemInfo">
            <!-- Your dynamic item content will be injected here -->
          </div>
        </div>
    
        <!-- Button Footer -->
        <div id="modal-buttons-confirmitem">
          <button id="confirmAddItemBtn" class="confirm-btn">Confirm</button>
          <button id="cancelAddItemBtn" class="cancel-btn">Cancel</button>
        </div>
    
      </div>
    </div>

    <!-- Modal: Item Reached Batch Threshold -->
    <div id="modal-batch-threshold-reached" class="modal hidden">
      <div class="modal-content-batch-threshold">
        <div class="modal-header-batch-threshold">
          Item Reached Batch Limit
        </div>

        <div class="modal-body-batch-threshold">
          <p>This item has been scanned the maximum allowed times for this batch.</p>
          <p>Please place it in its assigned location and perform a manual count.</p>

          <p><strong>Scanned Count:</strong> <span id="scanned-count-display">‚Äî</span></p>

          <label for="input-manual-count">
            Enter Manual Count:
            <input type="number" id="input-manual-count" min="0" class="input-style-manual-count" placeholder="Enter confirmed quantity" />
          </label>

          <p id="manual-count-error-msg" class="manual-count-error hidden">
            ‚ùå The manual count does not match the scanned count. Please recount and try again.
          </p>
        </div>

        <div class="modal-footer-batch-threshold">
          <button id="btn-confirm-manual-count" class="btn-batch-threshold-confirm">Confirm Count</button>
          <button id="btn-cancel-manual-count" class="btn-batch-threshold-close">Cancel</button>
        </div>
      </div>
    </div>



  <audio id="scan-sound" src="scan-ding.mp3" preload="auto"></audio>

  <!--initialize buttons-->
  <script src="https://unpkg.com/lucide@latest"></script>
  <script>
    lucide.createIcons();
  </script>
</body>
</html>
